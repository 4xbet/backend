# Карта Покрытия Тестами

Этот документ описывает стратегию тестирования для сервиса управления командами и спортсменами.

## Типы тестов

Проект включает в себя два основных типа тестов:

1.  **Модульные тесты (Unit Tests)**: Эти тесты проверяют отдельные компоненты системы в изоляции. Они находятся в директории `tests/unit`.
2.  **Интеграционные тесты (Integration Tests)**: Эти тесты проверяют взаимодействие между несколькими компонентами системы, включая базу данных. Они находятся в директории `tests/integration`.

## Покрытие компонентов

### 1. API Endpoints

-   **Расположение тестов**: `tests/unit/api/`
-   **Описание**: Модульные тесты для каждого эндпоинта (`/teams` и `/athletes`). Они проверяют корректность обработки запросов, валидацию данных и правильность ответов, используя моки для репозиториев.

### 2. Репозитории (Data Access Layer)

-   **Расположение тестов**: `tests/unit/db/` и `tests/integration/`
-   **Описание**:
    -   **Модульные тесты**: Проверяют базовую логику репозиториев (`BaseRepository`) и специфических репозиториев (`TeamRepository`, `AthleteRepository`) с использованием моков сессии базы данных.
    -   **Интеграционные тесты**: Проверяют CRUD-операции репозиториев с реальной тестовой базой данных (in-memory SQLite), чтобы убедиться в правильности взаимодействия с SQLAlchemy.

### 3. Сервисы (Business Logic)

-   **Расположение тестов**: `tests/unit/services/` и `tests/integration/`
-   **Описание**:
    -   **Модульные тесты**: Проверяют бизнес-логику `TeamServiceFacade`, используя моки репозиториев. Это позволяет тестировать логику сервиса, не затрагивая базу данных.
    -   **Интеграционные тесты**: Проверяют работу `TeamServiceFacade` с реальными репозиториями и тестовой базой данных, чтобы убедиться в корректности сквозных сценариев, таких как создание команды со спортсменами.

### 4. Модели базы данных (SQLAlchemy Models)

-   **Расположение тестов**: `tests/unit/db/test_models.py`
-   **Описание**: Проверяют корректность определения моделей SQLAlchemy, включая отношения между ними.

## Как запускать тесты

Для запуска всех тестов выполните следующую команду из корневой директории `teams`:

```bash
poetry run pytest
```
